<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="frBoardMapper">
  
  <!-- 아래는 게시글 갯수 -->
	<select id="selectListCount" resultType="_int">
	SELECT  COUNT(*)
 	 	FROM TB_FREE
  	WHERE F_STATUS='Y'
	
	</select>
  
  		<!--//게시글 조회 메소드  게시글 전체 조회1 -->
  	<resultMap type="frBoard" id="frBoardResultSet">
  	
  	<result column="F_NO" property="fNo"/>
   	<result column="F_WRITER" property="fWriter"/>
   	<result column="F_TYPE" property="fType"/>
   	<result column="F_TITLE" property="fTitle"/>
   	<result column="F_CONTENT" property="fContent"/>
   	<result column="F_COUNT" property="fCount"/>
   	<result column="F_CREATE_DATE" property="fCreateDate"/>
   	<result column="F_UPDATE_DATE" property="fUpdateDate"/>
   	<result column="F_DELETE_DATE" property="fDeleteDate"/>
    <result column="F_STATUS" property="fStatus"/>
   	
  	</resultMap>
  	
	<!-- 게시글 조회2 -->
	<select id="selectList" resultMap="frBoardResultSet">
	  SELECT F_NO
			,F_WRITER
			,F_TYPE
			,F_TITLE
			,F_CONTENT
			,F_COUNT
			,F_CREATE_DATE
			,F_UPDATE_DATE
			,F_DELETE_DATE
			,F_STATUS
    FROM TB_FREE 
    WHERE F_STATUS='Y' 
   ORDER BY F_NO DESC
	</select>
	
		<!-- 아래는 조회수증가  -->
	<update id="increaseCount">
	UPDATE TB_FREE 
	SET F_COUNT = F_COUNT+1 
	WHERE F_NO = #{fNo}
	AND F_STATUS ='Y'
	</update>
	
	<!-- 아래는 게시판 상세보기 -->
	<select id="frboardDetailView" resultMap="frBoardResultSet">
	SELECT 		 FRB.F_NO
				,FRB.F_TITLE
				,FRB.F_CONTENT
				,FRB.F_WRITER		
				,TRBA.FA_ORIGIN_NAME	
				,FRB.F_COUNT	
				,FRB.F_CREATE_DATE
				,TRBA.FA_FILE_PATH || TRBA.FA_CHANGE_NAME "fTitleimg"
				
	FROM TB_FREE FRB , TB_FREE_ATTACH TRBA
	WHERE F_STATUS='Y'
		AND FRB.F_NO = TRBA.F_NO
		AND  FRB.F_NO = #{fNo}
	ORDER BY FRB.F_NO DESC
	</select>
	
	
	<!--  게시글등록 1 (사진 미포함) -->
	<insert id="insertFrBoard1">
	INSERT INTO TB_FREE(
						 F_NO
						,F_TITLE			
						,F_CONTENT	
						,F_TYPE	
				)VALUES(
						SEQ_FNO.NEXTVAL
						,#{fTitle}		
						,#{fContent}
						,2
						)	
	</insert>
	
	<!--  게시글등록 2 (사진 포함) -->
	<insert id="insertAttFrBoard2" parameterType="java.util.List">
	INSERT INTO TB_FREE_ATTACH(
				 FA_NO
				,F_NO
				,FA_ORIGIN_NAME
				,FA_CHANGE_NAME			
				
	)SELECT SEQ_FANO.NEXTVAL,SEQ_FNO.CURRVAL, A.*
		FROM (
				<foreach collection="list" item="item" index="index" separator="union all">
					SELECT #{ item.faOrginName }
						  ,#{ item.faChangeName }
					FROM SYS.DUAL	  
				</foreach>
			  )A
	</insert>
  
  
  </mapper>